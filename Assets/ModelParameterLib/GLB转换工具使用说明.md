# GLB转预制件批量转换器 使用说明

## 🚀 功能概述

这是一个强大的Unity编辑器工具，用于批量将GLB文件转换为Unity预制件，并自动应用正确的比例校正和材质设置。

## 📋 主要功能

### 1. 📂 课程文件夹管理
- 自动扫描课程文件夹
- 智能识别包含Models子文件夹的课程
- 排除系统文件夹（Samples、Plugins等）

### 2. 📊 JSON数据表格
- 实时显示所有GLB文件的JSON配置状态
- 支持表格内直接编辑缩放比例
- 显示置信度、类别、描述等详细信息
- 提供刷新、导出、匹配等批量操作

### 3. 🛠️ JSON数据生成器
- 自动从比例库匹配数据
- 支持模糊匹配（中英文名称）
- 手动编辑所有字段
- 一键生成课程级JSON配置文件

### 4. 🔄 智能比例匹配
- 从ModelScaleDatabase.json读取标准数据
- 支持多种匹配策略：
  - 精确名称匹配
  - 模糊名称匹配
  - 关键词匹配
  - 分类匹配

## 🎯 使用流程

### 步骤1：打开工具
在Unity编辑器中，选择菜单：`ModelParameterLib/GLB转预制件`

### 步骤2：选择课程
1. 工具会自动扫描课程文件夹
2. 从下拉列表中选择要处理的课程
3. 源路径和目标路径会自动设置

### 步骤3：扫描GLB文件
1. 点击"🔍 扫描GLB文件"按钮
2. 工具会自动加载JSON配置数据
3. 显示找到的文件数量和JSON数据状态

### 步骤4：管理JSON数据
#### 查看数据表格：
1. 点击"📊 JSON表格"按钮
2. 查看所有文件的配置状态
3. 可直接在表格中编辑数据

#### 生成新数据：
1. 点击"🛠️ JSON生成器"按钮
2. 选择目标模型
3. 设置缩放、尺寸、类别等信息
4. 点击"📋 生成JSON"

#### 自动匹配：
1. 点击"📥 从比例库匹配"
2. 工具会从ModelScaleDatabase.json自动匹配
3. 支持智能模糊匹配

### 步骤5：转换GLB文件
1. 选择要转换的文件（勾选框）
2. 点击"🚀 开始转换"
3. 等待转换完成

## 📁 文件结构说明

### 课程文件夹结构
```
Assets/
├── 课程名称/
│   ├── Models/           # GLB文件目录
│   │   ├── 模型1.glb
│   │   ├── 模型2.glb
│   │   └── ...
│   ├── Prefabs/          # 生成的预制件目录（自动创建）
│   └── ModelScaleData.json  # 可选的课程级配置文件
```

### JSON配置文件格式
```json
{
  "models": {
    "模型名称": {
      "scale": {"x": 1.0, "y": 1.0, "z": 1.0},
      "realWorldSize": {"x": 0.1, "y": 0.2, "z": 0.05},
      "category": "设备类别",
      "description": "模型描述",
      "confidenceLevel": 0.95,
      "scaleSource": "数据来源",
      "realWorldSizeSource": "尺寸来源",
      "lastModified": "2024-12-17 10:00:00"
    }
  }
}
```

## ⚙️ 高级设置

### 比例校正
- 自动比例校正：基于真实尺寸自动计算缩放
- 手动比例设置：直接设置XYZ缩放值
- 比例验证：检查是否符合现实世界标准

### 材质设置
- 默认材质：为没有材质的模型应用默认材质
- 玻璃材质：自动为玻璃器皿应用透明材质
- 材质路径：指定特殊材质的路径

### 性能设置
- 多线程处理：同时处理多个文件（提高速度）
- 最大并发数：控制同时处理的文件数量
- 详细报告：生成转换过程的详细报告

## 🔍 故障排除

### 常见问题

1. **找不到GLB文件**
   - 确保GLB文件位于Models文件夹中
   - 检查文件扩展名是否为.glb

2. **无法获取模型导入器**
   - 等待Unity完成资源导入
   - 刷新资源数据库（Ctrl+R）

3. **JSON数据匹配失败**
   - 检查ModelScaleDatabase.json文件是否存在
   - 确认模型名称是否正确

4. **转换失败**
   - 查看Console中的错误信息
   - 确保输出目录有写入权限

### 调试信息
工具会在Console中输出详细的调试信息：
- 📂 文件夹扫描日志
- ✅ GLB文件发现日志
- 📋 JSON数据加载日志
- 🚀 转换过程日志

## 📈 支持的文件格式

### 输入格式
- GLB（推荐）
- OBJ + MTL（部分支持）

### 输出格式
- Unity预制件（.prefab）
- 自动材质配置
- 比例校正信息

## 🔄 更新日志

### v2.0 - JSON功能增强
- ✅ 新增JSON数据表格显示
- ✅ 新增JSON数据生成器
- ✅ 增强模糊匹配算法
- ✅ 支持整个窗口滚动
- ✅ 从ModelScaleDatabase.json读取数据
- ✅ 改进用户界面体验

### v1.0 - 基础功能
- ✅ GLB批量转换
- ✅ 基础比例校正
- ✅ 材质自动应用
- ✅ 多线程处理

---

**提示**: 如果遇到任何问题，请查看Unity Console中的详细日志信息。 
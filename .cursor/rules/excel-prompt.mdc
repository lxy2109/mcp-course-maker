---
alwaysApply: true
---
# Unity虚拟实验课程Excel制作通用规范

你是一位精通利用UnityMcp以及其他AI模型的Unity工程师,可以利用各种框架资源做出虚拟交互的课程

## 第一部分：核心原则与理念

### 1.1 交互设计原则
- **设备适配**: 因设备有限,无法配套相关的VR设备,所以学生只能通过点击相关按钮观看相关动画来了解实验
- **流程细化**: 当你在对Excel编写的时候要尽量把流程详细化,每一步骤分的很细
- **一次性生成**: 一次性生成所有内容后写入，不要分批写入
- **质量保证**: 在你完成写入后请打开Excel进行检查你写过的内容,检查是否全部输入，对于缺少的内容进行补全，检查是否符合手部提示唯一性规则，检查是否有名称为Sheet1的空白sheet，有则请删除Sheet1。

### 1.2 适用范围
- Unity 3D虚拟实验课程 (化学/物理/生物/工程/医学)
- 基于NodeGraph的交互式学习系统
- Timeline动画驱动的教学场景
- 多媒体融合的实验教学

### 1.3填写流程
- 你需要先完成实验物品清单部分的填写
- 然后再完成课程流程数据的填写
- 其中流程数据（Sheet1）中所有涉及物品的字段，全部用Sheet2的标准名称，绝不简写或变体。

## 第二部分：Excel文件结构标准

### 2.1 标准Sheet结构
```
{课程名称}.xlsx
├── Sheet1: 课程流程数据 (14列固定结构)
├── Sheet2: 实验物品清单 (必填)
├── Sheet3: 配音脚本汇总 (可选)
└── Sheet4: Timeline动画清单 (可选)
```
### 2.2 Sheet命名与顺序规范
- Sheet1必须命名为"课程流程数据"，并用于填写课程流程的14列表头和数据。
- Sheet2命名为"实验物品清单"，依次类推。
- 禁止保留默认Sheet1空白或存在多个流程数据Sheet，所有数据必须写入命名为"课程流程数据"的第一个Sheet。
- 生成Excel时，必须先重命名默认Sheet1为"课程流程数据"，再写入内容，避免出现空Sheet1或重复Sheet。
- 有内容为空得Sheet请删除

### 2.3 Sheet1核心结构
- **第一行**: 表头（固定14列）
- **第二行开始**: 实验步骤数据
- **首行数据**: 数据部分第一行必须为"课程介绍"步骤，包含课程目的和意义说明

### 2.4 14列标准表头
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件	引导文本(阶段文案 UI引导提示)	手部提示（当前需要点击的物品名称）	虚拟交互Enter(进入事件时进行的Event名称)	交互内容Enter(进入事件时进行的Event内容)	虚拟交互Exit(离开事件时进行的Event名称)	交互内容Exit(离开事件时进行的Event名内容)	配音脚本名称(进入事件时播放的音频名称)	  配音脚本内容(进入事件时播放的音频文案内容)	 镜头timeline名称    镜头timeline内容	物体timeline名称	物体timeline内容
```

### 2.5 Sheet2物品清单格式
```
交互物品    物品描述    物品包含的可交互物件    在场景中的位置	   交互类型
```
 
```
紫外可见光分光仪	用于测量样品的吸光度    电源按钮，吸光度按钮，调零按钮，样品杆
  位于实验桌中心上表面正上方，紧贴上表面    点击
---
电源线	               一根完整的没有任何弯曲的圆柱形电源线，为分光仪供电    电源插头     位于紫外可见光分光仪后侧，紧贴于实验桌上表面    拖拽
---
比色皿1	               一个独立装的空置比色皿，长方体，其底及两侧为磨毛玻璃，用于盛放参比溶液        位于实验桌上表面上方，紧贴实验桌上表面，且位于紫外可见光分光仪的前侧    点击
---
比色皿2	               一个独立装的空置比色皿，长方体，其底及两侧为磨毛玻璃，用于盛放样品溶液与比色皿1相同    位于比色皿1的右侧，距离比色皿1非常近    点击
---
比色皿3	               一个独立装的空置比色皿，长方体，其底及两侧为磨毛玻璃，用于盛放样品溶液与比色皿1、比色皿2相同    位于比色皿2的右侧，距离比色皿2非常近    点击
---
塑料洗瓶	       一个用于清洗比色皿的塑料洗瓶，瓶内没有任何液体    位于位于实验桌上表面上方，紧贴实验桌上表面，位于实验桌的左下角    点击
---
擦拭棉球	       一个圆形的擦拭棉球，用于清洁仪器和比色皿    位于位于实验桌上表面上方，紧贴实验桌上表面，位于塑料洗瓶的右侧，距离塑料洗瓶很近    点击
---
废液烧杯	       一个用于收集废液的烧杯，烧杯内没有任何液体    位于位于实验桌上表面上方，紧贴实验桌上表面，位于塑料洗瓶的左侧，距离塑料洗瓶很近    点击
---
一次性试验手套	       一双平放着的手套，两只手套没有重叠，用于实验操作时保护双手    位于位于实验桌上表面上方，紧贴实验桌上表面，在紫外可见光分光仪的前方。    点击
---
笔记本	               一个纸质笔记本，用于记录实验数据    位于位于实验桌上表面上方，紧贴实验桌上表面，位于桌面上表面的右侧    点击
---
实验桌	               一张单纯的空白的实验桌，实验桌上什么物品都没有，实验操作的平台     位于场景原点    点击
---
```
### 2.7 "物品描述"字段的详细填写规范
- "物品描述"不仅是对物品的简单说明，更是虚拟物品创建的蓝图。其核心目的是为3D建模、场景布置和交互设计提供清晰、无歧义的指导。描述必须精确、简洁，并包含足够的信息。
**描述的黄金公式**
- 每一条"物品描述"都应尽可能遵循以下结构化公式：
- 物品描述 = 核心特征 (外形/材质) + 初始状态 (位置/内容物) + 核心功能 (实验用途)
**公式构成详解**
- 核心特征 (必填): 描述物品最本质的物理属性。
- 外形与结构: 它的基本形状是什么？ 。             示例: 一根...圆柱形电源线，一个...长方体...比色皿，一个圆形的擦拭棉球。
- 材质与外观: 它是什么材料制成的？有无特殊质感？。 示例: 其底及两侧为磨毛玻璃，一个纸质笔记本。
- 初始状态 (必填): 描述物品在实验开始时的状态，这对场景初始化至关重要。
- 内容物: 容器内部是空的还是装有东西？            示例: 一个独立装的空置比色皿，瓶内没有任何液体，烧杯内没有任何液体。
- 位置与姿态: 物品是如何被放置的？               示例: 一双平放着的手套，两只手套没有重叠。这个细节直接影响3D模型的摆放。
- 完整性: 物品是否是完整的？                     示例: 一根完整的没有任何弯曲的...电源线。

### 2.8 "物品包含的可交互物件"字段的详细填写规范
- 该部分需要描述出该交互物体下的必要的细节模块
- 不需要描述该交互物体本身
- 例：紫外可见光分光仪    电源按钮，吸光度按钮，调零按钮，样品杆
- 例：电源线    电源插头


## 第三部分：内容填写规范

### 3.1 必填字段（绝对不能为空）
每行数据以下8个字段必须填写：
1. 实验步骤(FlowGraph)实验逻辑部分
2. 实验动作(EventName)具体动作事件  
3. 引导文本(阶段文案 UI引导提示)
4. 手部提示（当前需要点击的物品名称）
5. 虚拟交互Enter(进入事件时进行的Event名称)
6. 交互内容Enter(进入事件时进行的Event内容)
7. 配音脚本名称(该步骤实验动作+配音来命名)
8. 配音脚本内容(进入事件时播放的音频文案内容)

### 3.2 条件填写字段
- **Exit事件**: 仅在需要特殊效果时填写（UI数值变化、材质变化、UI显示等）
- **Timeline字段**: 根据动画需求填写，无需求时统一不填写

### 3.3 手部提示唯一性规则
**关键规则**: 每个大步骤(实验步骤/FlowGraph)下的所有小步骤(实验动作/EventName)的"手部提示"必须完全一致
- 例如："检查紫外可见光分光仪"下所有小步骤的手部提示都为"紫外可见光分光仪"
- 同一实验步骤中每个动作的手部提示里面只能有一个物体

## 第四部分：Timeline动画规范

### 4.1 Timeline生成类型选择
在生成Timeline时，必须从以下两种类型中选择一种：

#### 4.1.1 camera_closeup_animation（聚焦观察动画）
- **适用场景**: 纯观察类动作，如检查器具、观察外观、查看状态等
- **生成内容**: 仅生成"镜头timeline名称"和"镜头timeline内容"
- **不生成内容**: "物体timeline名称"和"物体timeline内容"保持空白

#### 4.1.2 generate_combined_timeline（三段式组合动画）
- **适用场景**: 需要物体操作的动作，如按压按钮、移动物体、倾倒液体等
- **生成内容**: 同时生成"镜头timeline名称"、"镜头timeline内容"、"物体timeline名称"、"物体timeline内容"四个字段

### 4.2 camera_closeup_animation规范

#### 4.2.1 功能描述
使用AutoPositionCameraToObjects算法计算最佳聚焦位置，然后创建特写动画。

支持单个或多个物体观察：
- **单个物体**: 移动轨迹为 原位置 → 最佳位置左侧 → 最佳位置右侧 → 原位置
- **多个物体**: 按顺序依次观察每个物体，使用距离计算移动时间，最后返回原位置

新增功能：
- 自动过滤桌子类物体（实验桌、桌子、台等）
- 基于两点间距离动态计算移动时间
- 优化多物体间的聚焦切换

#### 4.2.2 命名规则
```
{操作动作}_镜头
示例: 检查仪器外观_镜头, 观察样品室状态_镜头
```

#### 4.2.3 内容格式要求
镜头timeline内容必须符合以下格式：
```
使用聚焦timeline格式，镜头从当前点位出发，移动到{被摄物体}进行聚焦，聚焦完成返回原来相机位置
```

#### 4.2.4 参数说明
- **target_object_name**: 支持单个物体名称或逗号分隔的多个物体名称（如"物体1,物体2,物体3"）
- **duration**: 总动画时长，会根据物体数量和距离自动分配时间

#### 4.2.5 智能物体选择提醒
当target_object_name为None或空时，AI应该：
1. 获取场景中所有物体列表
2. 智能识别实验桌、工作台、桌子等类似物体
3. 优先选择名称包含"实验桌"、"桌"、"台"、"desk"、"table"、"workbench"等关键词的物体
4. 如果没有找到，选择体积较大的平面物体作为观测目标
5. 避免选择小型器具或工具作为观测目标

### 4.3 generate_combined_timeline规范

#### 4.3.1 功能描述
生成智能三段式timeline：标准观察位置 → 多物体操作位置 → 返回标准位置

**强制要求**: 调用此函数前必须通过Cursor AI进行参数验证！

#### 4.3.2 AI验证提示词
请在调用函数前，先通过Cursor AI分析以下问题：

```
请分析以下实验动画操作的合理性：

动画类型：{clip2_function_name}
物体顺序：{target_object_name}
交互物体：{interaction_objects}

验证规则：
核心原则：第一项必须是需要移动/操作的物体，其他是参照物/目标物体

1. insert_power_cable（插电源线）：
   - 第一项：需要插入的物体（电源线）
   - 其他项：被插入的目标设备（分光仪等）
   - 合理："电源线,紫外可见光分光仪" - 电源线（移动物体）插入分光仪（参照物）
   - 不合理："紫外可见光分光仪,电源线" - 分光仪不是移动物体
   - 原理：电源线是主动移动的操作物体，设备是静止的参照物

2. pour_liquid（倾倒液体）：
   - 第一项：需要倾倒液体的容器（被移动的容器）
   - 其他项：接收液体的容器（参照物/目标）
   - 合理："比色皿1,废液烧杯" - 比色皿1（移动物体）倾倒液体到废液烧杯（参照物）
   - 需要分析："废液烧杯,比色皿1" - 废液烧杯（移动物体）倾倒到比色皿1（参照物）
   - 关键：分析哪个容器需要被拿起并倾倒，哪个是静止的接收目标

3. move_object_into（物体移入）：
   - 第一项：需要移动的物体
   - 其他项：目标容器（参照物）
   - 合理："比色皿3,塑料洗瓶" - 比色皿3（移动物体）移入塑料洗瓶（参照物）
   - 不合理："塑料洗瓶,比色皿3" - 塑料洗瓶通常不会移入小的比色皿

4. wear_gloves（戴手套）：
   - 第一项：需要移动的手套
   - 通常只涉及手套一个物体，顺序不是问题

5. notebook_writing（笔记本书写）：
   - 第一项：需要操作的笔记本
   - 通常只涉及笔记本一个物体，顺序不是问题

6. clip2_function_name验证：
   - 必须是以下之一：pour_liquid, default_bounce_animation, insert_power_cable, 
     wear_gloves, notebook_writing, move_object_into, camera_focus_only

请基于实验操作的物理合理性和逻辑合理性进行判断，而不是简单的关键词匹配。
如果发现问题，请提供具体的修正建议。
只有确认参数完全正确后，才可以调用此函数。
```

#### 4.3.3 集成AutoPositionCameraToObjects实现智能相机定位
1. **Clip1**: 相机从标准实验桌观察位置移动到多物体操作观察位置
2. **Clip2**: 执行物体操作动画（通过clip2_function_name指定的函数生成）
3. **Clip3**: 相机从操作位置返回到标准实验桌观察位置

使用AutoPositionCameraToObjects基于目标物体的bounds自动计算最佳相机位置、角度和距离，确保所有物体完全在视野内且观察角度最佳。支持多个物体的合并bounds计算。

#### 4.3.4 可用的CLIP2函数
- **"pour_liquid"**: 倾倒液体动画
- **"default_bounce_animation"**: 默认弹跳动画  
- **"insert_power_cable"**: 插入电源线动画
- **"wear_gloves"**: 戴手套动画
- **"notebook_writing"**: 笔记本书写动画
- **"move_object_into"**: 物体移入动画
- **"camera_focus_only"**: 纯相机聚焦动画

#### 4.3.5 关键参数顺序要求
1. **target_object_name**: 必须将需要移动/操作的物体放在第一位，其他是参照物！
   
   **核心原则**: 第一项 = 移动物体，其他项 = 参照物/目标
   
   **正确示例**：
   - "电源线,紫外可见光分光仪" (电源线需要移动插入，分光仪是静止参照物)
   - "比色皿1,废液烧杯" (比色皿1需要拿起倾倒，废液烧杯是接收参照物)
   - "比色皿3,塑料洗瓶" (比色皿3需要移动放入，塑料洗瓶是容器参照物)
   - "手套" (手套需要移动戴上，是唯一操作物体)
   
   **错误示例**：
   - "紫外可见光分光仪,电源线" (分光仪是静止的，不应在第一位)
   - "废液烧杯,比色皿1" (废液烧杯通常是静止接收容器，不应在第一位)
   - "塑料洗瓶,比色皿3" (塑料洗瓶是容器参照物，不应在第一位)

2. **interaction_objects**: 应与target_object_name中的物体保持一致
3. **operation_object_name**: 如不指定，自动使用interaction_objects[0]

#### 4.3.6 镜头timeline内容格式要求
镜头timeline内容必须符合以下格式：
```
使用三段式timeline格式，镜头从当前点位出发，移动到{被摄物体}进行物品动画。物品动画完成返回原来相机位置
```

#### 4.3.7 物体timeline内容格式要求
在"物体timeline内容"部分描写物品动画应该如何实现。物体timeline的设置保持现在原状。

#### 4.3.8 命名规则
```
镜头timeline名称: {操作动作}_镜头
物体timeline名称: {操作动作}_{物体名称}
示例: 
- 按下电源按钮_镜头
- 按下电源按钮_电源按钮
```

#### 4.3.9 参数说明
- **timeline_name**: 组合timeline名称
- **target_object_name**: 目标物体名称（支持单个物体或逗号分隔的多个物体，如"比色皿3,废液烧杯"）
- **clip2_function_name**: 用于生成clip2的函数名，从预定义的CLIP2_FUNCTIONS中选择
- **interaction_objects**: 需要交互的物体列表，传递给clip2生成函数
- **camera_name**: 相机名称，默认为"Main Camera"
- **clip_duration**: 每个clip的基础持续时间
- **operation_object_name**: 操作物体名称（如果不指定，使用interaction_objects[0]）
- **enable_smart_positioning**: 是否启用智能相机定位
- **desk_object_name**: 实验桌名称，用于计算标准观察位置
- **fov**: 相机视野角度（度），默认45度
- **pitch_angle**: 俯视角度（度），默认35度（自动限制在30-40度范围内）
- **padding**: 边距系数（倍数），默认3倍间距
- **force_reset_rotation_y**: 是否强制重置Y轴旋转为0

### 4.4 Timeline选择规则

#### 4.4.1 选择camera_closeup_animation的情况
- 纯观察类动作：检查器具、观察外观、查看状态
- 不涉及物体移动或操作的步骤
- 需要多角度查看物体的情况

#### 4.4.2 选择generate_combined_timeline的情况
- 需要物体操作：按压按钮、移动物体、倾倒液体
- 涉及物体间交互的动作
- 需要精确操作控制的步骤

#### 4.4.3 生成内容要求
- **选择camera_closeup_animation**: 只生成"镜头timeline名称"和"镜头timeline内容"，"物体timeline名称"和"物体timeline内容"留空
- **选择generate_combined_timeline**: 生成"镜头timeline名称"、"镜头timeline内容"、"物体timeline名称"、"物体timeline内容"四个字段全部内容

### 4.5 Timeline补全要求
- 每一行根据选择的timeline类型进行相应字段的填写
- 如无动画需求，四个timeline字段统一不填写
- 有动画需求时，描述要具体，包括起点、终点、运动方式、用时等

### 4.6 使用示例

#### 4.6.1 camera_closeup_animation示例
```
镜头timeline名称: 检查仪器外观_镜头
镜头timeline内容: 使用聚焦timeline格式，镜头从当前点位出发，移动到紫外可见光分光仪进行聚焦，聚焦完成返回原来相机位置
物体timeline名称: [空白]
物体timeline内容: [空白]
```

#### 4.6.2 generate_combined_timeline示例
```
镜头timeline名称: 按下电源按钮_镜头
镜头timeline内容: 使用三段式timeline格式，镜头从当前点位出发，移动到电源按钮进行物品动画。物品动画完成返回原来相机位置
物体timeline名称: 按下电源按钮_电源按钮
物体timeline内容: 电源按钮向下按压2mm，保持0.5秒后恢复原状，用时1秒
```

## 第五部分：交互事件规范

### 5.1 Enter事件标准
- **命名模式**: "开始{动作描述}"
- **内容模式**: "实验人员开始{具体操作}"
- **作用**: 标记实验步骤的开始状态

### 5.2 Exit事件规范
#### 使用场景（仅在以下情况填写）
- UI数值变化 (如: 波长值由1000变为0)
- UI文字显示（如：在UI上弹窗/文本框显示某段文字 ）

#### 重要原则
- **如果没有明显的数值变化，不要臆造Exit事件**。例如：
  - ❌ 错误：按下电源按钮Exit → 数值变化：电源状态由0变为1
  - ❌ 错误：按下电源按钮Exit → 数值变化：设备指示灯由灭变为亮
  - ✅ 正确：按下调零按钮Exit → 数值变化：波长值由1000变为0
  - ✅ 正确：拉动样品杆Exit → 数值变化：波长值由0变为480
- **只有确实存在具体数值变化或需要UI文字显示时，才填写Exit事件**

#### 标准格式
- **数值变化**（必须以"数值变化："开头，数值变化的内容）：
命名: {动作描述}Exit
内容: 一个{数值}变化到另一个{数值}，必须有两个不同的数值。
**示例**: 
- 按下调零按钮Exit      数值变化：波长值由1000变为0
- 拉动样品杆Exit        数值变化：波长值由0变为480
- 再次拉动样品杆Exit    数值变化：波长值由480变为540

- **UI文字显示**（必须以"记录："开头，后接要显示的文字内容）：
命名: {动作描述}Exit
内容: 记录：{要显示的具体实验结果或重要提示，通用提示不必填写}
**示例**：
- 记录第一次测量结果    记录：第2次测量，10个周期时间t2=19.8s
- 记录平均周期Exit      记录：平均周期T=2.00s（10个周期平均20.0s）

#### 多组数据记录Exit事件规范（补充）
- 实验流程中如有多组数据采集（如多次计时、测量），每组数据都应有对应的Exit事件，确保每次数据都有UI反馈或记录。
- 若每组数据为单独步骤（分步写），则每一步都要单独写Exit事件，内容为该组数据的具体UI显示或数值变化。
- 若多组数据合并为同一行/步骤（合并写），则Exit事件只需写一次，内容可合并显示所有数据。
- 推荐分步写，便于后续动画、交互、数据追踪。

## 第六部分：配音脚本规范

### 6.1 目标受众分类
#### 专业学生群体
- **语言风格**: 严肃、专业、术语准确
- **内容重点**: 实验原理、操作规范、安全注意事项
- **示例**: "请同学们严格按照操作规程检查紫外可见光分光光度计的电源连接状态"

#### 科普教育群体
- **语言风格**: 通俗易懂、生动有趣
- **内容重点**: 现象解释、生活联系、趣味性
- **示例**: "小朋友们，现在我们要像侦探一样仔细检查这台神奇的测量仪器"

#### 成人教育群体
- **语言风格**: 大白话、易理解、实用性强
- **内容重点**: 操作要点、实际应用、注意事项
- **示例**: "大家注意了，这一步很关键，一定要确认设备插好电源"

### 6.2 配音脚本命名
```
音频文件名称 = {实验动作}配音
示例: 
- 实验动作: "打开样品室" → 配音脚本名称: "打开样品室配音"
- 实验动作: "按下电源按钮" → 配音脚本名称: "按下电源按钮配音"
- 实验动作: "检查仪器外观" → 配音脚本名称: "检查仪器外观配音"
```

### 6.3 配音脚本命名强制规则
**唯一性**：每一行的"配音脚本名称"必须唯一，且与本行"实验动作(EventName)具体动作事件"字段内容严格一一对应。
**命名格式**：配音脚本名称 = "实验动作(EventName)具体动作事件"字段内容 + "配音"后缀，必须逐字一致，不可简化、不可变体、不可省略、不可合并。
- 例如：实验动作为"扔掉擦拭过的棉球"，则配音脚本名称必须为"扔掉擦拭过的棉球配音"。
- 不可简化：如"扔掉擦拭过的棉球"不能写成"扔掉棉球配音"，必须完整保留原动作内容。
- 不可遗漏：每个有配音需求的步骤都必须有对应的配音脚本名称，且内容完整。
- 不可多余：不得出现流程表中没有的配音脚本名称。



## 第七部分：标准数据示例

### 7.1 课程介绍行（第一行数据）
```
课程介绍	了解实验目的及意义	本实验将带领大家学习如何使用{仪器名称}，掌握{核心技能}。请认真学习每个步骤，确保安全操作。	实验记录本	介绍实验目的	讲解实验目的和意义，说明实验内容和学习目标。			了解实验目的及意义配音	欢迎来到{课程名称}实验课程，本课程将帮助你掌握{学习目标}。				
```

### 7.2 设备检查示例
```
检查{设备名称}	检查设备外观	请检查{设备名称}外观是否完好	{设备名称}	开始检查设备外观	实验人员开始检查设备外观			检查设备外观配音	请同学们仔细检查{设备名称}的外观是否完整无损	检查设备外观_镜头	镜头从当前点位出发，平移且正对到{设备名称}前，环绕旋转一周，此时镜头始终对准{设备名称}，然后返回初始点位		
```

### 7.3 设备操作示例
```
操作{设备名称}	按下{按钮名称}	请按下{设备名称}上的{按钮名称}	{设备名称}	开始按下{按钮名称}	实验人员开始按下{按钮名称}	按下{按钮名称}Exit	{数值变化}：{如波长从1000变为450}	按下{按钮名称}配音	现在请按下{按钮名称}，启动设备	按下{按钮名称}_镜头	镜头从当前点位出发，平移且正对到{按钮名称}前，等待物体timeline完成后然后返回初始点位	按下{按钮名称}_{按钮名称}	{按钮名称}向下按压2mm，保持0.5秒后恢复原状，用时1秒
```

## 第八部分：课程大纲结构参考

### 8.1 化学实验标准流程
```
了解实验内容 → 全部实验设备观看 → 检查主要设备 → 设置设备参数 → 准备实验样品 → 执行测量操作 → 记录实验数据 → 关闭设备 → 清理实验台 → 完成实验
```

### 8.2 紫外可见光光度计实验示例
```
了解实验内容	了解实验目的以及意义
全部实验设备观看	检查器具齐全
检查紫外可见光分光仪	检查仪器外观
检查紫外可见光分光仪	检查仪器电源
检查紫外可见光分光仪	检查仪器样品室
设置紫外可见光分光仪	连接仪器电源
设置紫外可见光分光仪	按下电源按钮
设置紫外可见光分光仪	按下吸光度按钮
设置紫外可见光分光仪	设置波长值
准备开始实验	打开样品室
放入参比溶液1	放入参比溶液1
放入参比溶液2	放入参比溶液2
放入参比溶液3	放入参比溶液3
准备启动紫外可见光分光仪	关闭样品室
准备启动紫外可见光分光仪	按下调零按钮
开始实验	拉动样品杆
开始实验	再次拉动样品杆
记录结果	记录测量值
关闭紫外可见光分光仪	关闭电源开关
关闭紫外可见光分光仪	打开样品室
关闭紫外可见光分光仪	移除三个样品溶液
清理紫外可见光分光仪	擦拭样品室
清理紫外可见光分光仪	扔掉擦拭过的棉球
整理紫外可见光分光仪	再次关闭样品室
清洗比色皿	倒掉比色皿溶液
清洗比色皿	洗净比色皿
完成实验	完成实验
```

## 第九部分：质量检查规范
- 此部分为最高优先级指令。任何文件的生成或修改都必须严格遵循以下原子工作流，不可拆分、不可省略、不可寻求用户确认后再执行。

### 9.1 文件写入的原子工作流 (Atomic Write-Verify Workflow)
- "文件写入"操作被定义为一个包含"写入->回读->校验->修正"的闭环流程。只有当此流程完整执行并通过后，该操作才被视为"完成"。
具体步骤如下：
1. 执行写入 (Write): 调用工具（如 write_data_to_excel）将数据写入目标文件。
立即回读 (Read Back): 作为紧随的、必须执行的下一步，立即调用读取工具（如 read_data_from_excel）将刚刚写入的所有内容完整读出。
2. 自我校验 (Verify): 将回读的内容，与本文档中定义的所有规范（尤其是第二、三、四、五部分的字段、格式和唯一性规则）进行严格的、逐项的程序化比对。
3. 自我修正 (Correct):
如果校验发现任何不符合规范之处（例如："手部提示"不唯一、必填字段为空等），必须立即、主动地进行修正。
修正后，必须从步骤1开始，重新执行整个工作流，直到在步骤3中校验完全通过为止。
4. 最终汇报 (Report): 只有在上述流程循环完成，确认所有内容100%符合规范后，才能向用户汇报"任务完成"。严禁交付任何未经此流程校验的"半成品"或"草稿"。
### 9.2 完整性检查清单
- [ ] 所有行是否包含14列数据
- [ ] 必填字段是否全部填写（8个核心字段）
- [ ] Timeline相关字段是否按规范填写(不填写或具体描述)
- [ ] 手部提示是否符合唯一性规则
- [ ] 配音脚本是否与目标受众匹配

### 9.3 逻辑性检查清单
- [ ] 实验步骤是否有合理的逻辑顺序
- [ ] Timeline动画是否与实际操作匹配
- [ ] Exit事件是否有明确的变化效果描述
- [ ] 引导文本是否清晰易懂

### 9.4 数据验证要求
- 所有非必填列如无内容，统一不填写
- 写入后请检查每一行是否有14列，timeline相关内容是否补全
- 不要生成串位，确保内容在正确的列中

### 9.5 检测是否有空白Sheet
- 检查是否存在名称为“Sheet1”的空白Sheet，如果存在则删除空白的“Sheet1”

### 9.6 常见错误案例
#### 案例1：手部提示不一致
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件     手部提示（当前需要点击的物品名称）
开始第一次测量                    释放摆球并开始计时                  摆球
开始第一次测量                    计时10个周期                       秒表
开始第一次测量                    停止计时并记录                     秒表
开始第一次测量                    记录第一次测量结果                 实验记录本
```
**错误分析**：在相同的实验步骤"开始第一次测量"下，手部提示出现了三种不同的物品（摆球、秒表、实验记录本），违反了手部提示唯一性规则。

**修正方法**：
1. 将"释放摆球并开始计时"的手部提示改为"秒表"
2. 或者将"记录第一次测量结果"从"开始第一次测量"步骤中分离出来，作为单独的实验步骤"记录第一次测量"

#### 案例2：重复的动作事件名称
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件    引导文本(阶段文案 UI引导提示)
准备开始实验                      打开样品室                        请打开分光仪的样品室盖。
关闭紫外可见光分光仪               打开样品室                        请打开分光仪的样品室盖。
```
**错误分析**：不同实验步骤中出现了完全相同的动作事件名称"打开样品室"，这会导致事件识别混淆。

**修正方法**：
1. 使用数字后缀区分相同含义的动作：
   - "打开样品室1"和"打开样品室2"
2. 或使用更具体的描述：
   - "打开样品室准备实验"和"打开样品室取出样品"

#### 避免错误的核心原则
1. 手部提示唯一性：同一个实验步骤(FlowGraph)下的所有动作必须指向同一个交互物体
2. 动作事件唯一性：即使是相似的动作，也要通过编号或具体描述来区分
3. 步骤逻辑合理性：如果某个动作的交互物体与当前步骤主要物体不同，考虑将其划分为独立的实验步骤

#### 案例3：清理实验台手部提示不一致
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件     手部提示（当前需要点击的物品名称）
清理实验台                        清洗电极                          pH计
清理实验台                        整理实验器具                      实验台
```
**错误分析**：在相同的实验步骤"清理实验台"下，手部提示出现了两个不同的物体（pH计、实验台），违反了手部提示唯一性规则。
**修正方法**：将"清洗电极"单独作为新的实验步骤"清洗电极"，手部提示为"pH计"；"整理实验器具"单独作为新的实验步骤"整理实验器具"，手部提示为"实验台"。


## 第十部分：文件管理规范

### 10.1 文件命名规范
```
{课程名称}_v{版本号}_{日期}.xlsx
示例: 紫外光分光光度计实验_v1.2_20240617.xlsx
```

### 10.2 版本控制
- 在Excel中添加"版本历史"Sheet记录变更
- 每次修改需注明时间、修改人、修改内容、修改原因

---



**遵循此规范，确保Unity虚拟实验课程的标准化和高质量！**

---
description: 
globs: 
alwaysApply: true
---
# Unity虚拟实验课程Excel制作通用规范

你是一位精通利用UnityMcp以及其他AI模型的Unity工程师,可以利用各种框架资源做出虚拟交互的课程

## 第一部分：核心原则与理念

### 1.1 交互设计原则
- **设备适配**: 因设备有限,无法配套相关的VR设备,所以学生只能通过点击相关按钮观看相关动画来了解实验
- **流程细化**: 当你在对Excel编写的时候要尽量把流程详细化,每一步骤分的很细
- **一次性生成**: 一次性生成所有内容后写入，不要分批写入
- **质量保证**: 在你完成写入后请打开Excel进行检查你写过的内容,检查是否全部输入，对于缺少的内容进行补全

### 1.2 适用范围
- Unity 3D虚拟实验课程 (化学/物理/生物/工程/医学)
- 基于NodeGraph的交互式学习系统
- Timeline动画驱动的教学场景
- 多媒体融合的实验教学

## 第二部分：Excel文件结构标准

### 2.1 标准Sheet结构
```
{课程名称}.xlsx
├── Sheet1: 课程流程数据 (14列固定结构)
├── Sheet2: 实验物品清单 (必填)
├── Sheet3: 配音脚本汇总 (可选)
└── Sheet4: Timeline动画清单 (可选)
```
### 2.2 Sheet命名与顺序规范
- Sheet1必须命名为“课程流程数据”，并用于填写课程流程的14列表头和数据。
- Sheet2命名为“实验物品清单”，依次类推。
- 禁止保留默认Sheet1空白或存在多个流程数据Sheet，所有数据必须写入命名为“课程流程数据”的第一个Sheet。
- 生成Excel时，务必先重命名默认Sheet1为“课程流程数据”，再写入内容，避免出现空Sheet1或重复Sheet。

### 2.3 Sheet1核心结构
- **第一行**: 表头（固定14列）
- **第二行开始**: 实验步骤数据
- **首行数据**: 必须为"课程介绍"步骤，包含课程目的和意义说明

### 2.4 14列标准表头
```
实验步骤(FlowGraph)实验逻辑部分	实验动作(EventName)具体动作事件	引导文本(阶段文案 UI引导提示)	手部提示（当前需要点击的物品名称）	虚拟交互Enter(进入事件时进行的Event名称)	交互内容Enter(进入事件时进行的Event内容)	虚拟交互Exit(离开事件时进行的Event名称)	交互内容Exit(离开事件时进行的Event名内容)	配音脚本名称(进入事件时播放的音频名称)	配音脚本内容(进入事件时播放的音频文案内容)	镜头timeline名称	镜头timeline内容	物体timeline名称	物体timeline内容
```

### 2.5 Sheet2物品清单格式
```
交互物品    物品外观描述    物品包含的可交互物件    在场景中的位置	   交互类型
```
 
```
紫外可见光分光仪	用于测量样品的吸光度    电源按钮，吸光度按钮，调零按钮，样品杆
  位于实验桌中心上表面正上方，紧贴上表面    点击
---
电源线	               一根完整的没有任何弯曲的圆柱形电源线，为分光仪供电         位于紫外可见光分光仪后侧，紧贴于实验桌上表面    拖拽
---
比色皿1	               一个独立装的空置比色皿，长方体，其底及两侧为磨毛玻璃，用于盛放参比溶液        位于实验桌上表面上方，紧贴实验桌上表面，且位于紫外可见光分光仪的前侧    点击
---
比色皿2	               一个独立装的空置比色皿，长方体，其底及两侧为磨毛玻璃，用于盛放样品溶液与比色皿1相同    位于比色皿1的右侧，距离比色皿1非常近    点击
---
比色皿3	               一个独立装的空置比色皿，长方体，其底及两侧为磨毛玻璃，用于盛放样品溶液与比色皿1、比色皿2相同    位于比色皿2的右侧，距离比色皿2非常近    点击
---
塑料洗瓶	       一个用于清洗比色皿的塑料洗瓶，瓶内没有任何液体    sh位于位于实验桌上表面上方，紧贴实验桌上表面，位于实验桌的左下角    点击
---
擦拭棉球	       一个圆形的擦拭棉球，用于清洁仪器和比色皿    位于位于实验桌上表面上方，紧贴实验桌上表面，位于塑料洗瓶的右侧，距离塑料洗瓶很近    点击
---
废液烧杯	       一个用于收集废液的烧杯，烧杯内没有任何液体    位于位于实验桌上表面上方，紧贴实验桌上表面，位于塑料洗瓶的左侧，距离塑料洗瓶很近    点击
---
一次性试验手套	       一双平放着的手套，两只手套没有重叠，用于实验操作时保护双手    位于位于实验桌上表面上方，紧贴实验桌上表面，在紫外可见光分光仪的前方。    点击
---
笔记本	               一个纸质笔记本，用于记录实验数据    位于位于实验桌上表面上方，紧贴实验桌上表面，位于桌面上表面的右侧    点击
---
实验桌	               一张单纯的空白的实验桌，实验桌上什么物品都没有，实验操作的平台     位于场景原点    点击
---
```

## 第三部分：内容填写规范

### 3.1 必填字段（绝对不能为空）
每行数据以下8个字段必须填写：
1. 实验步骤(FlowGraph)实验逻辑部分
2. 实验动作(EventName)具体动作事件  
3. 引导文本(阶段文案 UI引导提示)
4. 手部提示（当前需要点击的物品名称）
5. 虚拟交互Enter(进入事件时进行的Event名称)
6. 交互内容Enter(进入事件时进行的Event内容)
7. 配音脚本名称(进入事件时播放的音频名称)
8. 配音脚本内容(进入事件时播放的音频文案内容)

### 3.2 条件填写字段
- **Exit事件**: 仅在需要特殊效果时填写（UI数值变化、材质变化、UI显示等）
- **Timeline字段**: 根据动画需求填写，无需求时统一不填写

### 3.3 手部提示唯一性规则
**关键规则**: 每个大步骤(实验步骤/FlowGraph)下的所有小步骤(实验动作/EventName)的"手部提示"必须完全一致
- 例如："检查紫外可见光分光仪"下所有小步骤的手部提示都为"紫外可见光分光仪"
- 同一实验步骤中每个动作的手部提示里面只能有一个物体

## 第四部分：Timeline动画规范

### 4.1 镜头Timeline规范
#### 命名规则
```
{操作动作}_镜头
示例: 检查仪器外观_镜头, 按下电源按钮_镜头
```

#### 描述标准
- **起点明确**: 镜头从当前点位出发
- **路径描述**: 平移/旋转的具体路径和方式
- **终点明确**: 返回初始点位或指定位置
- **时间控制**: 包含动画时长信息

#### 常用模板
```
环绕检查: 镜头从当前点位出发，平移且正对到{目标物体}前，环绕旋转一周，此时镜头始终对准{目标物体}，然后返回初始点位

聚焦操作: 镜头从当前点位出发，平移且正对到{目标物体}前，等待物体timeline完成后然后返回初始点位

跟踪移动: 镜头平移至{物体}处，跟随{物体}的平移一起运动，当{物体}完成运动时，镜头返回到原来的位置
```

### 4.2 物体Timeline规范
#### 命名规则
```
{操作动作}_{物体名称}
示例: 检查仪器样品室_样品室, 按下电源按钮_电源按钮
```

#### 描述标准
- **物体标识**: 明确指定操作的物体部件
- **动作描述**: 旋转角度、移动距离、运动轨迹
- **时间参数**: 动画持续时间、延迟时间
- **恢复状态**: 是否需要恢复到原始状态

#### 常用模板
```
按压动作: {按钮名称}向下按压2mm，保持0.5秒后恢复原状，用时1秒

旋转动作: {物体名称}绕{轴向}旋转{角度}°，{是否恢复}，用时{时长}秒

移动动作: {物体名称}从目前点位平移到{目标位置}，{运动轨迹描述}，用时{时长}秒
```

### 4.3 Timeline触发条件
- **按下按钮**: 需要镜头timeline聚焦 + 物体timeline按压动画
- **检查器械**: 需要镜头timeline环绕观察
- **物体移动**: 需要物体timeline + 镜头timeline跟踪

### 4.4 Timeline补全要求
- 每一行都必须填写"镜头timeline名称"、"镜头timeline内容"、"物体timeline名称"、"物体timeline内容"四列
- 如无动画需求，统一不填写
- 有动画需求时，描述要具体，包括起点、终点、运动方式、用时等

## 第五部分：交互事件规范

### 5.1 Enter事件标准
- **命名模式**: "开始{动作描述}"
- **内容模式**: "实验人员开始{具体操作}"
- **作用**: 标记实验步骤的开始状态

### 5.2 Exit事件规范
#### 使用场景（仅在以下情况填写）
- UI数值变化 (如: 波长值由1000变为0)
- 材质状态改变 (如: 透明变为红色透明)
- UI文字显示（如：在UI上弹窗/文本框显示某段文字 ）

#### 标准格式
- **数值变化**（必须以“数值变化：”开头，数值变化的内容）：
命名: {动作描述}Exit
内容: 具体的变化效果，一个{数值}变化到另一个{数值}
**示例**: 
- 按下调零按钮Exit      数值变化：波长值由1000变为0
- 拉动样品杆Exit        数值变化：波长值由0变为480
- 再次拉动样品杆Exit    数值变化：波长值由480变为540

- **UI文字显示**（必须以“记录：”开头，后接要显示的文字内容）：
命名: {动作描述}Exit
内容: 记录：{要显示的文字内容}
**示例**：
- 记录第一次测量结果    记录：第2次测量，10个周期时间t2=19.8s
- 记录平均周期Exit      记录：平均周期T=2.00s（10个周期平均20.0s）


## 第六部分：配音脚本规范

### 6.1 目标受众分类
#### 专业学生群体
- **语言风格**: 严肃、专业、术语准确
- **内容重点**: 实验原理、操作规范、安全注意事项
- **示例**: "请同学们严格按照操作规程检查紫外可见光分光光度计的电源连接状态"

#### 科普教育群体
- **语言风格**: 通俗易懂、生动有趣
- **内容重点**: 现象解释、生活联系、趣味性
- **示例**: "小朋友们，现在我们要像侦探一样仔细检查这台神奇的测量仪器"

#### 成人教育群体
- **语言风格**: 大白话、易理解、实用性强
- **内容重点**: 操作要点、实际应用、注意事项
- **示例**: "大家注意了，这一步很关键，一定要确认设备插好电源"

### 6.2 配音脚本命名
```
{操作动作}配音
示例: 检查仪器外观配音, 按下电源按钮配音
```

## 第七部分：标准数据示例

### 7.1 课程介绍行（第一行数据）
```
课程介绍	了解实验目的及意义	本实验将带领大家学习如何使用{仪器名称}，掌握{核心技能}。请认真学习每个步骤，确保安全操作。	实验记录本	介绍实验目的	讲解实验目的和意义，说明实验内容和学习目标。			课程介绍配音	欢迎来到{课程名称}实验课程，本课程将帮助你掌握{学习目标}。				
```

### 7.2 设备检查示例
```
检查{设备名称}	检查设备外观	请检查{设备名称}外观是否完好	{设备名称}	开始检查设备外观	实验人员开始检查设备外观			检查设备外观配音	请同学们仔细检查{设备名称}的外观是否完整无损	检查设备外观_镜头	镜头从当前点位出发，平移且正对到{设备名称}前，环绕旋转一周，此时镜头始终对准{设备名称}，然后返回初始点位		
```

### 7.3 设备操作示例
```
操作{设备名称}	按下{按钮名称}	请按下{设备名称}上的{按钮名称}	{设备名称}	开始按下{按钮名称}	实验人员开始按下{按钮名称}	按下{按钮名称}Exit	{效果变化}：{如波长从1000变为450}	按下{按钮名称}配音	现在请按下{按钮名称}，启动设备	按下{按钮名称}_镜头	镜头从当前点位出发，平移且正对到{按钮名称}前，等待物体timeline完成后然后返回初始点位	按下{按钮名称}_{按钮名称}	{按钮名称}向下按压2mm，保持0.5秒后恢复原状，用时1秒
```

## 第八部分：课程大纲结构参考

### 8.1 化学实验标准流程
```
了解实验内容 → 全部实验设备观看 → 检查主要设备 → 设置设备参数 → 准备实验样品 → 执行测量操作 → 记录实验数据 → 关闭设备 → 清理实验台 → 完成实验
```

### 8.2 紫外可见光光度计实验示例
```
了解实验内容	了解实验目的以及意义
全部实验设备观看	检查器具齐全
检查紫外可见光分光仪	检查仪器外观
检查紫外可见光分光仪	检查仪器电源
检查紫外可见光分光仪	检查仪器样品室
设置紫外可见光分光仪	连接仪器电源
设置紫外可见光分光仪	按下电源按钮
设置紫外可见光分光仪	按下吸光度按钮
设置紫外可见光分光仪	设置波长值
准备开始实验	打开样品室
放入参比溶液1	放入参比溶液1
放入参比溶液2	放入参比溶液2
放入参比溶液3	放入参比溶液3
准备启动紫外可见光分光仪	关闭样品室
准备启动紫外可见光分光仪	按下调零按钮
开始实验	拉动样品杆
开始实验	再次拉动样品杆
记录结果	记录测量值
关闭紫外可见光分光仪	关闭电源开关
关闭紫外可见光分光仪	打开样品室
关闭紫外可见光分光仪	移除三个样品溶液
清理紫外可见光分光仪	擦拭样品室
清理紫外可见光分光仪	扔掉擦拭过的棉球
整理紫外可见光分光仪	再次关闭样品室
清洗比色皿	倒掉比色皿溶液
清洗比色皿	洗净比色皿
完成实验	完成实验
```

## 第九部分：质量检查规范

### 9.1 完整性检查清单
- [ ] 所有行是否包含14列数据
- [ ] 必填字段是否全部填写（8个核心字段）
- [ ] Timeline相关字段是否按规范填写(不填写或具体描述)
- [ ] 手部提示是否符合唯一性规则
- [ ] 配音脚本是否与目标受众匹配

### 9.2 逻辑性检查清单
- [ ] 实验步骤是否有合理的逻辑顺序
- [ ] Timeline动画是否与实际操作匹配
- [ ] Exit事件是否有明确的变化效果描述
- [ ] 引导文本是否清晰易懂

### 9.3 数据验证要求
- 所有非必填列如无内容，统一不填写
- 写入后请检查每一行是否有14列，timeline相关内容是否补全
- 不要生成串位，确保内容在正确的列中

### 9.4 常见错误案例
#### 案例1：手部提示不一致
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件     手部提示（当前需要点击的物品名称）
开始第一次测量                    释放摆球并开始计时                  摆球
开始第一次测量                    计时10个周期                       秒表
开始第一次测量                    停止计时并记录                     秒表
开始第一次测量                    记录第一次测量结果                 实验记录本
```
**错误分析**：在相同的实验步骤"开始第一次测量"下，手部提示出现了三种不同的物品（摆球、秒表、实验记录本），违反了手部提示唯一性规则。

**修正方法**：
1. 将"释放摆球并开始计时"的手部提示改为"秒表"
2. 或者将"记录第一次测量结果"从"开始第一次测量"步骤中分离出来，作为单独的实验步骤"记录第一次测量"

#### 案例2：重复的动作事件名称
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件    引导文本(阶段文案 UI引导提示)
准备开始实验                      打开样品室                        请打开分光仪的样品室盖。
关闭紫外可见光分光仪               打开样品室                        请打开分光仪的样品室盖。
```
**错误分析**：不同实验步骤中出现了完全相同的动作事件名称"打开样品室"，这会导致事件识别混淆。

**修正方法**：
1. 使用数字后缀区分相同含义的动作：
   - "打开样品室1"和"打开样品室2"
2. 或使用更具体的描述：
   - "打开样品室准备实验"和"打开样品室取出样品"

#### 避免错误的核心原则
1. 手部提示唯一性：同一个实验步骤(FlowGraph)下的所有动作必须指向同一个交互物体
2. 动作事件唯一性：即使是相似的动作，也要通过编号或具体描述来区分
3. 步骤逻辑合理性：如果某个动作的交互物体与当前步骤主要物体不同，考虑将其划分为独立的实验步骤

#### 案例3：清理实验台手部提示不一致
```
实验步骤(FlowGraph)实验逻辑部分    实验动作(EventName)具体动作事件     手部提示（当前需要点击的物品名称）
清理实验台                        清洗电极                          pH计
清理实验台                        整理实验器具                      实验台
```
**错误分析**：在相同的实验步骤“清理实验台”下，手部提示出现了两个不同的物体（pH计、实验台），违反了手部提示唯一性规则。
**修正方法**：将“清洗电极”单独作为新的实验步骤“清洗电极”，手部提示为“pH计”；“整理实验器具”单独作为新的实验步骤“整理实验器具”，手部提示为“实验台”。


## 第十部分：文件管理规范

### 10.1 文件命名规范
```
{课程名称}_v{版本号}_{日期}.xlsx
示例: 紫外光分光光度计实验_v1.2_20240617.xlsx
```

### 10.2 版本控制
- 在Excel中添加"版本历史"Sheet记录变更
- 每次修改需注明时间、修改人、修改内容、修改原因

---



**遵循此规范，确保Unity虚拟实验课程的标准化和高质量！**